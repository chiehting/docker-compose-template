global
    daemon
    maxconn 4096
    log stdout local0

defaults
    mode tcp
    timeout connect 5000ms
    timeout client 50000ms
    timeout server 50000ms
    option tcplog

# TDengine 服務負載均衡
#frontend tdengine_frontend
#    bind *:6030
#    default_backend tdengine_backend
#
#backend tdengine_backend
#    balance roundrobin
#    option tcp-check
#    tcp-check connect
#    server node1 tdengine-node1:6030 check inter 10s fall 5 rise 5
#    server node2 tdengine-node2:6030 check inter 10s fall 5 rise 5
#    server node3 tdengine-node3:6030 check inter 10s fall 5 rise 5

# RESTful API 負載均衡
frontend restful_frontend
    bind *:6041
    default_backend restful_backend

backend restful_backend
    balance roundrobin
    option tcp-check
    tcp-check connect
    server node1 tdengine-node1:6041 check inter 10s fall 5 rise 5
    server node2 tdengine-node2:6041 check inter 10s fall 5 rise 5
    server node3 tdengine-node3:6041 check inter 10s fall 5 rise 5

# 統計頁面
frontend stats
    mode http
    bind :8404
    stats enable
    stats refresh 30s
    stats uri /stats
    stats show-modules
